<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Лесной Лагерь - Регистрация</title>
    <style>
        * { box-sizing: border-box; }
        
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('https://i.ytimg.com/vi/j2nIMEMgcxQ/maxresdefault.jpg') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* Эффект стекла для карточки */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 20px;
        }

        h2 { text-align: center; color: #2d3436; margin-top: 0; }

        input, textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            outline: none;
        }

        input:focus { border-color: #2ecc71; }

        button {
            width: 100%;
            padding: 15px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover { background: #2ecc71; transform: scale(1.02); }
        button:disabled { background: #95a5a6; }

        .list-container {
            width: 100%;
            max-width: 450px;
        }

        .person-tag {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 15px;
            border-left: 5px solid #2ecc71;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #status { text-align: center; font-weight: bold; margin-top: 10px; color: #27ae60; }
        
        .header-text {
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="header-text">
        <h1>Нам нужны люди!</h1>
        <p>Запишись в наш лесной проект</p>
    </div>

    <div class="glass-card">
        <h2>Анкета</h2>
        <input type="text" id="fn" placeholder="Имя">
        <input type="text" id="ln" placeholder="Фамилия">
        <input type="number" id="age" placeholder="Возраст">
        <textarea id="goal" placeholder="Твои навыки или цель" rows="2"></textarea>
        <button id="btn" onclick="sendData()">Отправить</button>
        <div id="status"></div>
    </div>

    <div class="list-container">
        <h3 class="header-text">Участники:</h3>
        <div id="peopleList"></div>
    </div>

    <script>
        // Твой новый ID
        const API_URL = "https://api.npoint.io/29da76d74d4beedc7143";

        // Функция загрузки
        async function loadPeople() {
            try {
                const r = await fetch(API_URL);
                const data = await r.json();
                const list = Array.isArray(data) ? data : [];
                
                const div = document.getElementById('peopleList');
                if (list.length === 0) {
                    div.innerHTML = "<p style='color:white; text-align:center;'>Будь первым в списке!</p>";
                } else {
                    div.innerHTML = list.slice().reverse().map(p => `
                        <div class="person-tag">
                            <strong>${p.name}</strong>, ${p.age} лет<br>
                            <small>${p.goal}</small>
                        </div>
                    `).join('');
                }
                return list;
            } catch (e) {
                console.error(e);
                return [];
            }
        }

        // Функция отправки
        async function sendData() {
            const btn = document.getElementById('btn');
            const status = document.getElementById('status');
            
            const name = document.getElementById('fn').value + " " + document.getElementById('ln').value;
            const age = document.getElementById('age').value;
            const goal = document.getElementById('goal').value;

            if (!document.getElementById('fn').value || !age) {
                alert("Введи имя и возраст!");
                return;
            }

            btn.disabled = true;
            status.innerText = "Отправка...";

            try {
                const currentList = await loadPeople();
                currentList.push({ name, age, goal });

                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(currentList)
                });

                if (res.ok) {
                    status.innerText = "Успешно добавлено!";
                    document.querySelectorAll('input, textarea').forEach(i => i.value = '');
                    loadPeople();
                }
            } catch (e) {
                status.innerText = "Ошибка соединения.";
            } finally {
                btn.disabled = false;
            }
        }

        // Запуск при загрузке
        loadPeople();
    </script>
</body>
</html>
